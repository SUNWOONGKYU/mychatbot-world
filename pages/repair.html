<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê¸´ê¸‰ ë³µêµ¬ - My Chatbot World</title>
    <style>
        body {
            background-color: #111;
            color: white;
            font-family: sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            text-align: center;
        }

        .btn {
            background: #ec4899;
            color: white;
            border: none;
            padding: 20px 40px;
            font-size: 1.5rem;
            border-radius: 10px;
            cursor: pointer;
            font-weight: bold;
            margin-top: 20px;
            box-shadow: 0 0 20px rgba(236, 72, 153, 0.5);
        }

        .btn:active {
            transform: scale(0.98);
        }

        .log {
            margin-top: 20px;
            color: #888;
            font-size: 0.9rem;
            text-align: left;
            background: #222;
            padding: 10px;
            border-radius: 5px;
            width: 80%;
            max-width: 600px;
            height: 150px;
            overflow-y: auto;
        }
    </style>
</head>

<body>
    <h1>ğŸ”§ ë´‡ ë°ì´í„° ê¸´ê¸‰ ë³µêµ¬ ë„êµ¬</h1>
    <p>ì¨ë‹ˆë´‡ì´ ë³´ì´ì§€ ì•Šì„ ë•Œ ì´ ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”.<br>ë°ì´í„°ë¥¼ ê°•ì œë¡œ ìƒì„±í•˜ê³  ì—°ê²°í•©ë‹ˆë‹¤.</p>

    <button class="btn" onclick="emergencyFix()">ğŸš€ ì¨ë‹ˆë´‡ ê°•ì œ ì†Œí™˜ (Click)</button>

    <div class="log" id="logArea">ëŒ€ê¸° ì¤‘...</div>

    <script>
        function log(msg) {
            const area = document.getElementById('logArea');
            area.innerHTML += `<div>[${new Date().toLocaleTimeString()}] ${msg}</div>`;
            area.scrollTop = area.scrollHeight;
        }

        const SunnyBotData = {
            id: 'sunny-bot-sample',
            botName: 'ì¨ë‹ˆë´‡ (5ì¸ì˜ ìì•„ í†µí•©í˜•)',
            botDesc: 'ê¸°ì¡´ AI ì•„ë°”íƒ€ í”„ë¡œì íŠ¸ì—ì„œ ê°€ì ¸ì˜¨ 5ê°€ì§€ í˜ë¥´ì†Œë‚˜(ìì•„)ê°€ íƒ‘ì¬ëœ í†µí•© ë´‡ì…ë‹ˆë‹¤.',
            greeting: 'ì•ˆë…•í•˜ì„¸ìš”! ì¨ë‹ˆë´‡ì…ë‹ˆë‹¤. 5ê°€ì§€ ìì•„ë¥¼ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤. ì›í•˜ì‹œëŠ” ì—­í• ì„ ì„ íƒí•´ì£¼ì„¸ìš”!',
            personas: [
                { id: 'p_ai', name: 'AI Master', role: 'ì „ì§€ì „ëŠ¥í•œ AI ë§ˆìŠ¤í„°', model: 'logic', iqEq: 100, isVisible: true },
                { id: 'p_startup', name: 'Startup Accelerator', role: 'ìŠ¤íƒ€íŠ¸ì—… ì „ëµê°€', model: 'logic', iqEq: 90, isVisible: true },
                { id: 'p_cpa', name: 'ê³µì¸íšŒê³„ì‚¬', role: 'ì„¸ë¬´/íšŒê³„ ì „ë¬¸ê°€', model: 'logic', iqEq: 85, isVisible: true },
                { id: 'p_star', name: 'ë³„ ì• í˜¸ê°€', role: 'ìš°ì£¼ì™€ ê¿ˆì„ ì‚¬ë‘í•˜ëŠ” ë‚­ë§Œê°€', model: 'creative', iqEq: 60, isVisible: true },
                { id: 'p_life', name: 'ìˆœìˆ˜ ìƒí™œì¸', role: 'ì†Œì†Œí•œ í–‰ë³µì„ ì¦ê¸°ëŠ” ì´ì›ƒ', model: 'emotion', iqEq: 50, isVisible: true }
            ],
            faqs: [
                { q: 'ë„ˆëŠ” ëˆ„êµ¬ë‹ˆ?', a: 'ì €ëŠ” 5ê°€ì§€ ìì•„ë¥¼ ê°€ì§„ ì¨ë‹ˆë´‡ì…ë‹ˆë‹¤.' },
                { q: 'ë¬´ì—‡ì„ í•  ìˆ˜ ìˆì–´?', a: 'ì‚¬ì—… ì „ëµë¶€í„° ê°ì„±ì ì¸ ëŒ€í™”ê¹Œì§€ ë‹¤ì–‘í•œ ì£¼ì œë¡œ ëŒ€í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.' }
            ],
            templateId: 'custom',
            username: 'sunny',
            ownerId: 'admin',
            created: Date.now(),
            likes: 0
        };

        function emergencyFix() {
            const area = document.getElementById('logArea');
            area.innerHTML = ''; // Clear log

            try {
                log("ğŸ”„ ë³µêµ¬ í”„ë¡œì„¸ìŠ¤ ì‹œì‘...");

                // 1. ê¸°ì¡´ ë°ì´í„° ë¡œë“œ (ì•ˆì „í•˜ê²Œ)
                let bots = [];
                try {
                    bots = JSON.parse(localStorage.getItem('mcw_bots') || '[]');
                } catch (e) {
                    log("âš ï¸ ê¸°ì¡´ ë°ì´í„° ì†ìƒë¨. ì´ˆê¸°í™”í•©ë‹ˆë‹¤.");
                    bots = [];
                }

                // 2. ì¨ë‹ˆë´‡ ì¤‘ë³µ ì œê±° (IDë‚˜ username ê¸°ì¤€)
                const beforeCount = bots.length;
                bots = bots.filter(b => b.id !== 'sunny-bot-sample' && b.username !== 'sunny');
                log(`ê¸°ì¡´ ì¤‘ë³µ ë°ì´í„° ì •ë¦¬: ${beforeCount - bots.length}ê°œ ì‚­ì œë¨`);

                // 3. ìƒˆ ë°ì´í„° ì¶”ê°€
                bots.unshift(SunnyBotData); // ë§¨ ì•ì— ì¶”ê°€
                localStorage.setItem('mcw_bots', JSON.stringify(bots));
                log(`âœ… ì¨ë‹ˆë´‡ ë°ì´í„° ì£¼ì… ì™„ë£Œ (ì´ ${bots.length}ê°œ ë´‡)`);

                // 4. í”Œë˜ê·¸ ê°•ì œ ì„¤ì •
                localStorage.setItem('mcw_sample_init_admin', 'true');
                localStorage.setItem('mcw_sample_initialized', 'true');

                // 5. ê´€ë¦¬ì ì„¸ì…˜ ë³µêµ¬
                localStorage.setItem('mcw_current_user_id', 'admin');

                // Users ë°°ì—´ í™•ì¸
                let users = JSON.parse(localStorage.getItem('mcw_users') || '[]');
                if (!users.find(u => u.id === 'admin')) {
                    users.push({ id: 'admin', password: '1234', name: 'Master Admin', role: 'admin' });
                    localStorage.setItem('mcw_users', JSON.stringify(users));
                    log("âœ… ê´€ë¦¬ì ê³„ì • ìƒì„± ì™„ë£Œ");
                }

                log("ğŸ‰ ë³µêµ¬ ì™„ë£Œ! 3ì´ˆ í›„ ì´ë™í•©ë‹ˆë‹¤...");
                log("ì´ë™ ì£¼ì†Œ: dashboard/index.html");

                setTimeout(() => {
                    const unique = Date.now();
                    window.location.href = `dashboard/index.html?v=${unique}`;
                }, 3000);

            } catch (e) {
                log(`â›” ì¹˜ëª…ì  ì˜¤ë¥˜: ${e.message}`);
                alert("ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë¡œê·¸ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.");
            }
        }
    </script>
</body>

</html>